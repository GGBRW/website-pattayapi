window.require=function(){};
window.store=require("store");(function(b){function e(f){var g={};$.extend(g,window.store);g.get=function(h){if(!f[h]){f[h]={}}if(f[h].version){var i=store.get("_"+h+"-version");if(!i||parseFloat(f[h].version)!==parseFloat(i)){return undefined}}if(f[h].expire){return storeWithExpiration.get(h)}return store.get(h)};g.set=function(h,i){if(!f[h]){f[h]={}}if(f[h].version){store.set("_"+h+"-version",f[h].version)}if(f[h].expire){return storeWithExpiration.set(h,i,f[h].expire)}return store.set(h,i)};g.remove=function(h){store.remove("_"+h+"-version");return store.remove(h)};return g}var c={},d={inject:function(g,h){if(b.DM_ENV[g]){b[g]=b[g]||{};h=h||c[g]||b[g];for(var f in b.DM_ENV[g]){if(b.DM_ENV[g].hasOwnProperty(f)){h[f]=b.DM_ENV[g][f]}}}}},a={define:function(i,g,f){var h=c[i]||b[i];if(h&&!h.__preModule){return}h=g();if(!h){return}d.inject(i,h);if(f){b[i]=h}else{c[i]=h}h.store=h.__localstorageConf?e(h.__localstorageConf):window.store;delete (h.__localstorageConf);h.__initialize&&h.__initialize();delete (h.__initialize);h.__onDomReady&&$(h.__onDomReady);delete (h.__onDomReady);delete (h.__preModule)},__debug:function(f){return c[f]||b[f]||null}};PubSub.subscribe("envs:added",function(f){d.inject(f)});b._DM=a})(window);
_DM.define("DM_PlayerUtils",function(){var h=[],c=[],d=document.title,g=false,b=false,f=function(i){if(i==1){document.title="â–¶ "+d}else{document.title=d}},e=function(i){h.push(i);c.push({object:$("#"+i).get(0),id:i,previousState:0,pauseTimeout:0});if(c.length==1){DM_PlayerEvents.on("StateChange",i,f)}};var a={needsCssUpdate:function(){return $("html.gecko.win, html.gecko.linux").length&&$(playerV5).children("embed").first().length},hideAllPlayers:function(){if(typeof playerV5!=="undefined"){playerV5.pause();if(a.needsCssUpdate()){$(playerV5).css("visibility","hidden")}return}if(b){return}var i=function(l){if(!$("#"+l.id).closest("#popupContent").length){l.previousState=l.object.getPlayerState();var k=$(l.object);k.parent().addClass("invisible");k.css("visibility","hidden");a.pausePlayer(l)}};try{if(c.length){$.each(c,function(k,l){i(l)})}else{DM_PlayerEvents.on("Ready",function(k){i({object:$("#"+k).get(0),id:k})})}$(".dmpi_video_partnerplayer").each(function(k,l){$(l).parent().addClass("invisible").css("visibility","hidden")});b=true}catch(j){}},showAllPlayers:function(){if(typeof playerV5!=="undefined"){playerV5.play();if(a.needsCssUpdate()){$(playerV5).css("visibility","visible")}return}if(!b||g){return}try{$.each(c,function(k,m){clearTimeout(m.pauseTimeout);var l=$(m.object);l.parent().removeClass("invisible");l.css("visibility","visible");var j=m.object.getAPICustomParams();if(m.previousState==1||(m.previousState==-1&&j.autoplay)||m.previousState==3){m.object.playVideo()}});$(".dmpi_video_partnerplayer").each(function(k,l){var j=$(l);j.parent().removeClass("invisible");j.css("visibility","visible")});b=false}catch(i){}},pausePlayer:function(i){clearTimeout(i.pauseTimeout);var j=i.object.getPlayerState();if(j==-1||j==3||j>100){i.pauseTimeout=setTimeout(function(){a.pausePlayer(i)},500)}else{if(j==1){i.object.pauseVideo()}}},showWarning:function(k,i,j){$("#container_"+k).addClass("notice").empty().append($("<div/>").addClass("warning").append($("<p/>").addClass("title").html(i)).append($("<p/>").addClass("message").html(j)))},initialize:function(){DM_PlayerEvents.on("Ready",e)},__initialize:function(){PubSub.subscribe("popup:opening",a.hideAllPlayers);PubSub.subscribe("dm-tour:start",function(){g=true;a.hideAllPlayers()});PubSub.subscribe("popup:closed",a.showAllPlayers);PubSub.subscribe("dm-tour:end",function(){g=false;a.showAllPlayers()})}};return a},true);
_DM.define("DM_DispatchEvent",function(){var a={dispatch:function(d,c,e){var f={bubbles:false,cancelable:false,detail:e},b;if(typeof CustomEvent=="function"){b=new CustomEvent(c,f)}else{if(document.createEvent){b=document.createEvent("CustomEvent");b.initCustomEvent(c,f.bubbles,f.cancelable,f.detail)}else{b=document.createEventObject();b.eventType=c;event.detail=f.detail}}if(d.dispatchEvent){d.dispatchEvent(b)}else{if(d.fireEvent){d.fireEvent("on"+c,b)}}}};return a},true);
